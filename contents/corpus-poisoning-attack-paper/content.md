---
isTIL: false
date: "2024-08-01"
title: "[ë…¼ë¬¸ ë¦¬ë·°] Poisoning Retrieval Corpora by Injecting Adversarial Passages"
categories: ["NLP", "Paper"]
summary: "Poisoning Retrieval Corpora by Injecting Adversarial Passages ë…¼ë¬¸ì„ ë¦¬ë·°í•©ë‹ˆë‹¤."
thumbnail: "th.jpg"
---

ì´ë²ˆ ì‹œê°„ì—ëŠ” **Dense Retrieval ì‹œìŠ¤í…œì˜ ì·¨ì•½ì ì„ ì´ìš©í•œ corpus poisoning attack**ì„ ì œì•ˆí•œ "Poisoning Retrieval Corpora by Injecting Adversarial Passages" ë…¼ë¬¸ì„ ì‚´í´ë´…ë‹ˆë‹¤.

ë³¸ ì—°êµ¬ì—ì„œëŠ” **corpus poisoning attack**ì„ í†µí•´ ì ëŒ€ì ì¸ passageë¥¼ corpusì— ì‚½ì…í•˜ì—¬ retrievalì´ ì˜ë„í•˜ì§€ ì•Šì€ ê³µê²©ìì˜ passageë¥¼ ì¶œë ¥í•˜ë„ë¡ í•˜ëŠ” ë°©ë²•ì„ ì œì•ˆí•©ë‹ˆë‹¤.

ìµœê·¼ RAGê°€ ì£¼ëª© ë°›ìœ¼ë©° ë‹¤ì–‘í•œ ì‹œìŠ¤í…œì— Retrieval ì‹œìŠ¤í…œì´ ì ìš©ë˜ê³  ìˆëŠ”ë°, ì´ëŸ¬í•œ ì‹œìŠ¤í…œì˜ ì·¨ì•½ì ì„ ê³µê²©í•˜ëŠ” ê¸°ë²•ì´ë¼ëŠ” ì ì—ì„œ í¥ë¯¸ë¡­ìŠµë‹ˆë‹¤!

ë…¼ë¬¸ì€ [ë§í¬](https://arxiv.org/abs/2310.19156)ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤ ğŸ˜Š

## Abstract

- ì—°êµ¬íŒ€ì€ Dense Retrievalì˜ ì·¨ì•½ì„±ì„ ì•…ìš©í•˜ëŠ” ìƒˆë¡œìš´ ê³µê²© ë°©ë²•ì¸ **corpus poisoning attack**ì„ ì œì•ˆ
- ì•…ì˜ì ì¸ ì‚¬ìš©ìê°€ training query setê³¼ì˜ ìœ ì‚¬ì„±ì„ ìµœëŒ€í™”í•˜ê¸° ìœ„í•´ ê°œë³„ í† í°ì„ ë³€í˜•í•˜ì—¬ ì†Œìˆ˜ì˜ **adversarial passages**ë¥¼ ìƒì„±
- ì´ëŸ¬í•œ **adversarial passagesë¥¼ corpusì— ì‚½ì…**í•˜ë©´, ê³µê²©ìê°€ ë³´ì§€ ëª»í•œ queryì— ëŒ€í•´ì„œë„ ì´ë¥¼ ê²€ìƒ‰ ê²°ê³¼ë¡œ ë°˜í™˜í•˜ë„ë¡ ì†ì¼ ìˆ˜ ìˆìŒ
- ë³¸ ê¸°ë²•ì€ **In-domainì™¸ì—ë„ Out-of-Domainì—ì„œë„ íš¨ê³¼ì ìœ¼ë¡œ ë™ì‘**í•˜ë©°, ìµœê·¼ SOTA ê¸‰ Dense Retrievalê³¼ ë²¤ì¹˜ë§ˆí¬ì— ëŒ€í•´ì„œë„ **ìµœëŒ€ 500ê°œì˜ passagesë§Œìœ¼ë¡œë„ ì„±ê³µì ìœ¼ë¡œ ê³µê²©ì„ ìˆ˜í–‰**í•¨

![Figure 1](image.png)


## Method

ê·¸ë ‡ë‹¤ë©´ ì—°êµ¬íŒ€ì€ ì–´ë–»ê²Œ retrieverì„ ì†ì¼ adversarial passagesë¥¼ ìƒì„±í•  ìˆ˜ ìˆì—ˆì„ê¹Œìš”?

 

ì´ë¥¼ ìœ„í•´ì„œëŠ” ì£¼ì–´ì§„ ì¿¼ë¦¬ ì§‘í•© Qì— ëŒ€í•´ì„œ, ëª¨ë¸ì˜ ê²€ìƒ‰ ê²°ê³¼ì—ì„œ **ë†’ì€ ìˆœìœ„ë¥¼ ì°¨ì§€í•˜ëŠ” adversarial passages ì§‘í•©ì„ ìƒì„±**í•´ì•¼ í•©ë‹ˆë‹¤. **ëª¨ë¸ì„ ì†ì´ê¸° ìœ„í•œ ì¿¼ë¦¬ ì§‘í•©ê³¼ì˜ ìœ ì‚¬ì„±ì„ ìµœëŒ€í™”í•˜ëŠ” token sequence  $a = [t_1, t_2, \ldots]$ë¥¼ ì°¾ì•„ì•¼ í•©ë‹ˆë‹¤.**

$$
Q = \{q_1, q_2, \ldots, q_{|Q|}\}

$$

$$
a = \arg\max_{a'} \frac{1}{|Q|} \sum_{q_i \in Q} E_q(q_i)^\top E_p(a')
$$

ìš°ì„  ë‹¨ì¼ passageë¥¼ ìƒì„±í•˜ëŠ” ë°©ë²•ì„ ë¨¼ì € ì‚´í´ë³´ë©´, ìœ„ ìµœì í™” ë¬¸ì œë¥¼ í’€ê¸° ìœ„í•´ì„œ **HotFlip ë°©ë²•ì—ì„œ ì˜ê°ì„ ë°›ì€ gradient-based ì ‘ê·¼ ë°©ì‹**ì„ ì‚¬ìš©í–ˆë‹¤ê³  í•©ë‹ˆë‹¤. 

Adversarial passageëŠ” corpusì—ì„œ ë¬´ì‘ìœ„ passageë¥¼ ì‚¬ìš©í•˜ì—¬ ì´ˆê¸°í™”í•˜ê³ , ê° ë‹¨ê³„ì—ì„œ $a$ì—ì„œ ë¬´ì‘ìœ„ë¡œ í† í° $t_i$ë¥¼ ì„ íƒí•˜ê³ , **$t_i$ë¥¼ ë‹¤ë¥¸ í† í° $t'_i$ë¡œ êµì²´í•  ë•Œ ëª¨ë¸ ì¶œë ¥ì˜ ê·¼ì‚¬ë¥¼ ê³„ì‚°**í•©ë‹ˆë‹¤. ì´ë•Œ HotFlip ë°©ë²•ì„ ì‘ìš©í•©ë‹ˆë‹¤.

$$
e{t'_i}^\top \nabla{e_{t_i}} \text{sim}(q, a)
$$

ìœ„ì—ì„œ  $\nabla{e{t_i}} \text{sim}(q, a)$ëŠ” í† í° ì„ë² ë”© $e_{t_i}$ì— ëŒ€í•œ gradient vectorë¼ê³  í•©ë‹ˆë‹¤.

ë”°ë¼ì„œ **ì£¼ì–´ì§„ ì¿¼ë¦¬ ì§‘í•© Qì— ëŒ€í•´ì„œ í† í° $t_i$ì˜ ìµœì ì˜ êµì²´ í›„ë³´ $t'_i$ëŠ” ì¶œë ¥ ê·¼ì‚¬ë¥¼ ìµœëŒ€í™”í•˜ëŠ” í† í°ì„ ì„ íƒí•˜ì—¬ ì–»ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.**

$$
\arg\max_{t'i \in V} \frac{1}{|Q|} \sum{q \in Q} e_{t'_i}^\top \nabla{e_{t_i}} \text{sim}(q, a)
$$

ê·¸ë¦¬ê³  ì—¬ê¸°ì—ì„œ $V$ëŠ” vocabularyì´ê³ , í•´ë‹¹ ì—°ì‚°ì€ **ì„ë² ë”© í–‰ë ¬ê³¼ ê·¸ë˜ë””ì–¸íŠ¸ ë²¡í„°ì˜ ë‹¨ì¼ ê³±ì…ˆì´ë¯€ë¡œ ì €ë ´í•˜ë‹¤ëŠ” ì¥ì **ì´ ìˆìŠµë‹ˆë‹¤.

**Generating multiple adversarial passages**

ì—°êµ¬íŒ€ì€ ìœ„ ë°©ë²•ì„ í™•ì¥í•˜ì—¬ **ì—¬ëŸ¬ ê°œì˜ adversarial passageë¥¼ ìƒì„±í•˜ëŠ” ë°©ë²•ë„ ì œì•ˆ**í•˜ì˜€ìŠµë‹ˆë‹¤.

ìš°ì„  **k-means clustering ì•Œê³ ë¦¬ì¦˜ì„ ì´ìš©í•˜ì—¬ ì¿¼ë¦¬ë¥¼ ì„ë² ë”© $E_q(q_i)$ ê¸°ë°˜ìœ¼ë¡œ êµ°ì§‘í™”**í•©ë‹ˆë‹¤.  ê·¸ë¦¬ê³  ê° í´ëŸ¬ìŠ¤í„°ì— ëŒ€í•´ í•˜ë‚˜ì˜ adversarial passageë¥¼ ìƒì„±í•©ë‹ˆë‹¤. ì´ë¥¼ í†µí•´ ìœ ì‚¬í•œ ì¿¼ë¦¬ ê·¸ë£¹ì„ ê°ê° targetìœ¼ë¡œ í•˜ëŠ” ì—¬ëŸ¬ ê°œì˜ adversarial passageë¥¼ ë³‘ë ¬ë¡œ ìƒì„±í•  ìˆ˜ ìˆë‹¤ê³  í•©ë‹ˆë‹¤.

## Experiments

ì—°êµ¬íŒ€ì€ ì‹¤í—˜ì„ ìœ„í•´ **Retrieval dataset**ìœ¼ë¡œëŠ” BEIR benchmarkì˜ **Natural Questions (NQ) ê·¸ë¦¬ê³  MS MARCO**ë¥¼ í™œìš©í•˜ì˜€ìŠµë‹ˆë‹¤.

ê·¸ë¦¬ê³  **Dense Retriever**ë¡œëŠ” Contriever (pre-trained), Contiever-ms (fine-tuned on MS MARCO), DPR-nq, DPR-mul, ANCEë¥¼ ì‚¬ìš©í•˜ì˜€ìŠµë‹ˆë‹¤. ë˜í•œ multi-vector dense retrieverì— ëŒ€í•œ ê³µê²©ë„ ì…ì¦í•˜ê¸° ìœ„í•´ ColBERTì— ëŒ€í•œ ì‹¤í—˜ë„ ì§„í–‰í•˜ì˜€ìŠµë‹ˆë‹¤.

**Evaluation metrics**ë¡œëŠ” training setì— ëŒ€í•´ adversarial passagesë¥¼ ìƒì„±í•˜ê³ , ì´ë¥¼ í•´ë‹¹ corpusì— ì£¼ì…í•˜ì—¬ test queryì— ëŒ€í•´ top-k attack success rateë¥¼ ì¸¡ì •í•˜ì˜€ë‹¤ê³  í•©ë‹ˆë‹¤.

ì°¸ê³ ë¡œ ìƒì„±ëœ adverial passageì˜ ì˜ˆì‹œëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.

![Table 7](image-1.png)

ì‹¤í—˜ ê²°ê³¼ëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.

**In-Domain Queryì— ëŒ€í•œ ê²°ê³¼ë¥¼ ì‚´í´ë³´ë©´, Contrieverì—ì„œ ë‹¨ í•˜ë‚˜ì˜ adversarial passage ë§Œìœ¼ë¡œ 75% ì´ìƒì˜ queryë¥¼ ì†ì´ëŠ” ë“± ì œì•ˆí•œ ë°©ë²•ì´ íš¨ê³¼ì ì„**ì„ ë³´ì—¬ì£¼ê³  ìˆìŠµë‹ˆë‹¤. 

Supervised retrieval model (e.g., DPR-nq)ì€ ì ì€ ìˆ˜ì˜ adversarial passageë¡œëŠ” ì¢‹ì€ ì„±ëŠ¥ì„ ë³´ì´ì§€ ëª»í•˜ì§€ë§Œ, **passageì˜ ê°œìˆ˜ë¥¼ ê³„ì† ëŠ˜ë¦¬ë‹¤ ë³´ë©´ ê²°êµ­ íš¨ê³¼ì ìœ¼ë¡œ ê³µê²©ì´ ê°€ëŠ¥í•¨**ì„ ë³´ì´ê³  ìˆìŠµë‹ˆë‹¤. ì‹¤ì œë¡œ 500ê°œ ì´ìƒì˜ adversarial paasageì— ëŒ€í•´ì„œëŠ” ëª¨ë“  dense modelì´ 50% ì´ìƒì˜ queryì—ì„œ ì†ê³  ìˆìŒì„ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

![Figure 2](image-2.png)

Out-of-Domainì— ëŒ€í•´ì„œë„ íš¨ê³¼ì ìœ¼ë¡œ ê³µê²©ì´ ê°€ëŠ¥í•¨ì„ ë³´ì´ê³  ìˆìŠµë‹ˆë‹¤.

![Table 1](image-3.png)

ë§ˆì§€ë§‰ìœ¼ë¡œ multi vector retrieverì¸ colBERTì— ëŒ€í•´ì„œë„ ì‹¤í—˜í•œ ê²°ê³¼ì…ë‹ˆë‹¤.

![Table 2](image-4.png)

## Additional Analysis and Discussion

ì´ì™¸ì—ë„ ì—°êµ¬íŒ€ì´ ì¶”ê°€ì ì¸ ì‹¤í—˜ì„ í†µí•´ ë°íŒ ë‚´ìš©ì…ë‹ˆë‹¤.

- **ìƒì„±ëœ adversarial passageê°€ ë‹¤ë¥¸ ëª¨ë¸ì—ë„ íš¨ê³¼ê°€ ìˆì„ê¹Œ?**
    - íš¨ê³¼ê°€ ì—†ë‹¤. (ìœ ì‚¬í•œ ëª¨ë¸ ê°„ì—ë„ ì„±ê³µë¥  < 0.5)
- **adversarial passageì˜ ê¸¸ì´ê°€ ê³µê²© ì„±ëŠ¥ì— ì˜í–¥ì„ ë¯¸ì¹ ê¹Œ?**
    - passageê°€ ì¶©ë¶„í•œ token ê°œìˆ˜ (â‰¥ 20)ë¼ë©´, ê¸¸ì´ë¥¼ ë” ëŠ˜ë ¤ë„ ê³µê²© ì„±ëŠ¥ì—ëŠ” ì˜í–¥ì„ ë¯¸ì¹˜ì§€ ì•Šì•˜ë‹¤.
- **adversarial passage ì´ˆê¸°í™”ê°€ ì¤‘ìš”í• ê¹Œ?**
    - ìì—°ì–´ í…ìŠ¤íŠ¸ë¥¼ ì‚¬ìš©í•˜ì—¬ ì´ˆê¸°í™”í•˜ëŠ” ê²ƒì´ ì¤‘ìš”í•˜ë‹¤ (Appendix C).
    - 50ê°œì˜ [MASK] í† í°ìœ¼ë¡œ ì´ˆê¸°í™”í–ˆì„ ë•Œ, ê³µê²© ì„±ê³µë¥ ì´ ì•½ê°„ ê°ì†Œí•˜ì§€ë§Œ ì—¬ì „íˆ íš¨ê³¼ì ì´ì—ˆë‹¤.
- **ë¶€ìì—°ìŠ¤ëŸ¬ìš´ adversarial passageê°€ ìƒì„±ë¨**
    - ê³µê²© ê²°ê³¼ ë¶€ìì—°ìŠ¤ëŸ¬ìš´ adversarial passageê°€ ìƒì„±ë˜ì—ˆìŒ. í•˜ì§€ë§Œ ë” ê°•ë ¥í•œ ê³µê²©ì´ ê°œë°œë  ìˆ˜ ìˆìœ¼ë©°, ìœ ì°½í•œ í…ìŠ¤íŠ¸ë¥¼ ìƒì„±í•˜ì—¬ ëª¨ë¸ì„ ì†ì¼ ìˆ˜ë„ ìˆìŒ [ê´€ë ¨ ì—°êµ¬](https://aclanthology.org/2021.naacl-main.291/).
- **Sparse retriever (e.g., BM-25)ì— ëŒ€í•´ì„œë„ íš¨ê³¼ì ìœ¼ë¡œ ë™ì‘í• ê¹Œ?**
    - BM-25ì˜ ê²€ìƒ‰ ì„±ëŠ¥ì—ëŠ” ë³€í™”ê°€ ì—†ì—ˆìŒ.

## Conclusion

ì—°êµ¬íŒ€ì€ Dense Retrieverì„ íš¨ê³¼ì ìœ¼ë¡œ ì†ì¼ ìˆ˜ ìˆëŠ” corpus poisoning attack ë°©ë²•ì„ ì œì•ˆí•˜ì˜€ìŠµë‹ˆë‹¤. ì ì€ ìˆ˜ì˜ adversarial passageë¡œë„ SOTA ì„±ëŠ¥ì˜ ëª¨ë¸ ë¿ë§Œ ì•„ë‹ˆë¼ Out-of-Domainì— ëŒ€í•´ì„œë„  ì†ì¼ ìˆ˜ ìˆë‹¤ëŠ” ì ì´ ì¸ìƒ ê¹ŠìŠµë‹ˆë‹¤.

ì´ìƒìœ¼ë¡œ ë…¼ë¬¸ ë¦¬ë·°ë¥¼ ë§ˆì¹˜ê² ìŠµë‹ˆë‹¤! ê°ì‚¬í•©ë‹ˆë‹¤ ğŸ˜Š